# CRCON QQ Bot 命令使用手册

本文档详细介绍了 CRCON QQ 机器人的所有可用命令及其使用方法。

## 命令分类

### 🎮 玩家命令（所有用户可用）
- [服务器信息查询](#服务器信息查询)
- [VIP 状态查询](#vip-状态查询)
- [帮助信息](#帮助信息)

### 🛠️ 管理员命令（需要超级用户权限）
- [玩家列表](#玩家列表)
- [踢出玩家](#踢出玩家)
- [封禁玩家](#封禁玩家)
- [惩罚玩家](#惩罚玩家)
- [切换玩家](#切换玩家)
- [地图管理](#地图管理)
- [服务器设置](#服务器设置)

### ⚙️ 系统命令
- [机器人状态](#机器人状态)
- [API 测试](#api-测试)
- [机器人重启](#机器人重启)

---

## 🎮 玩家命令

### 服务器信息查询

查询指定服务器的当前状态信息。

**命令格式**:
```
/服务器信息 [服务器编号]
/服务器状态 [服务器编号]
/server [服务器编号]
/status [服务器编号]
```

**参数说明**:
- `服务器编号`: 1 或 2，默认为 1

**使用示例**:
```
/服务器信息
/服务器信息 1
/server 2
/status
```

**返回信息**:
- 服务器名称
- 当前地图
- 在线玩家数量
- 游戏模式
- 服务器运行时间

### VIP 状态查询

查询指定玩家的 VIP 状态。

**命令格式**:
```
/查询vip <玩家名称> [服务器编号]
/vip查询 <玩家名称> [服务器编号]
/checkvip <玩家名称> [服务器编号]
```

**参数说明**:
- `玩家名称`: 要查询的玩家名称（必填）
- `服务器编号`: 1 或 2，默认为 1

**使用示例**:
```
/查询vip PlayerName
/vip查询 PlayerName 2
/checkvip "Player Name"
```

**返回信息**:
- VIP 状态（是/否）
- VIP 到期时间（如果是 VIP）
- 玩家在线状态

### 帮助信息

显示可用命令的帮助信息。

**命令格式**:
```
/帮助
/help
/指令
```

**使用示例**:
```
/帮助
/help
```

---

## 🛠️ 管理员命令

> ⚠️ **注意**: 以下命令需要超级用户权限，请确保您的 QQ 号在配置文件的 `SUPERUSERS` 列表中。

### 玩家列表

显示指定服务器的在线玩家列表。

**命令格式**:
```
/玩家列表 [服务器编号]
/players [服务器编号]
```

**参数说明**:
- `服务器编号`: 1 或 2，默认为 1

**使用示例**:
```
/玩家列表
/玩家列表 2
/players 1
```

**返回信息**:
- 玩家编号
- 玩家名称
- 队伍
- 击杀/死亡数
- 在线时长

### 踢出玩家

将指定玩家踢出服务器。

**命令格式**:
```
/踢出 <玩家编号或范围> [服务器编号] [原因]
/kick <玩家编号或范围> [服务器编号] [原因]
```

**参数说明**:
- `玩家编号或范围`: 单个编号（如 1）或范围（如 1-3）
- `服务器编号`: 1 或 2，默认为 1
- `原因`: 踢出原因，默认为 "违反服务器规则"

**使用示例**:
```
/踢出 1
/踢出 1-3 1 违规行为
/kick 5 2 "Inappropriate behavior"
```

### 封禁玩家

对玩家进行临时或永久封禁。

**临时封禁命令格式**:
```
/临时封禁 <玩家编号或范围> <时长> [服务器编号] [原因]
/tempban <玩家编号或范围> <时长> [服务器编号] [原因]
```

**永久封禁命令格式**:
```
/永久封禁 <玩家编号或范围> [服务器编号] [原因]
/permaban <玩家编号或范围> [服务器编号] [原因]
```

**参数说明**:
- `玩家编号或范围`: 单个编号或范围
- `时长`: 封禁时长，格式如 "1h"（1小时）、"30m"（30分钟）、"1d"（1天）
- `服务器编号`: 1 或 2，默认为 1
- `原因`: 封禁原因

**使用示例**:
```
/临时封禁 1 2h
/临时封禁 1-2 30m 1 作弊行为
/tempban 3 1d 2 "Cheating detected"
/永久封禁 5 恶意破坏
/permaban 1-3 2 "Multiple violations"
```

### 惩罚玩家

对玩家进行惩罚（通常是击杀）。

**命令格式**:
```
/惩罚 <玩家编号或范围> [服务器编号] [原因]
/punish <玩家编号或范围> [服务器编号] [原因]
```

**参数说明**:
- `玩家编号或范围`: 单个编号或范围
- `服务器编号`: 1 或 2，默认为 1
- `原因`: 惩罚原因

**使用示例**:
```
/惩罚 1
/惩罚 1-2 1 违规行为
/punish 3 2 "Rule violation"
```

### 切换玩家

将玩家切换到对方队伍。

**立即切换命令格式**:
```
/立即切换 <玩家编号或范围> [服务器编号]
/switch <玩家编号或范围> [服务器编号]
```

**死亡后切换命令格式**:
```
/死亡切换 <玩家编号或范围> [服务器编号]
/switchdeath <玩家编号或范围> [服务器编号]
```

**参数说明**:
- `玩家编号或范围`: 单个编号或范围
- `服务器编号`: 1 或 2，默认为 1

**使用示例**:
```
/立即切换 1
/立即切换 1-3 2
/switch 2
/死亡切换 1-2 1
/switchdeath 3
```

### 地图管理

更换服务器当前地图。

**命令格式**:
```
/换图 <地图名称或编号> [服务器编号]
/changemap <地图名称或编号> [服务器编号]
/切换地图 <地图名称或编号> [服务器编号]
```

**参数说明**:
- `地图名称或编号`: 地图名称或编号（支持中文名称、英文名称和编号）
- `服务器编号`: 1 或 2，默认为 1

**⚠️ 重要提示**:
- 地图切换命令执行后，**预计1分钟后生效**
- 机器人会提示"地图切换命令已执行"，这表示命令已成功发送到服务器
- 实际切换时间取决于服务器当前状态（游戏进行中可能需要等待回合结束）

**支持的地图**:

**🎯 Warfare 模式地图（编号1-10）**:
1. `carentan_warfare` - 卡朗坦
2. `driel_warfare` - 德里尔
3. `foy_warfare` - 芬诺维尔
4. `kharkov_warfare` - 哈尔科夫
5. `kursk_warfare` - 库尔斯克
6. `omahabeach_warfare` - 奥马哈海滩
7. `PHL_L_1944_Warfare` - 紫心小道
8. `remagen_warfare` - 雷马根
9. `stmereeglise_warfare` - 圣梅尔埃格利斯
10. `stmariedumont_warfare` - 圣玛丽杜蒙

**🎯 Offensive 模式地图（编号11-24）**:
11. `stmereeglise_offensive_ger` - 圣梅尔埃格利斯（德军进攻）
12. `stmereeglise_offensive_us` - 圣梅尔埃格利斯（美军进攻）
13. `utahbeach_offensive_ger` - 犹他海滩（德军进攻）
14. `utahbeach_offensive_us` - 犹他海滩（美军进攻）
15. `driel_offensive_ger` - 德里尔（德军进攻）
16. `driel_offensive_us` - 德里尔（美军进攻）
17. `omahabeach_offensive_ger` - 奥马哈海滩（德军进攻）
18. `omahabeach_offensive_us` - 奥马哈海滩（美军进攻）
19. `kharkov_offensive_ger` - 哈尔科夫（德军进攻）
20. `kharkov_offensive_us` - 哈尔科夫（美军进攻）
21. `carentan_offensive_ger` - 卡朗坦（德军进攻）
22. `carentan_offensive_us` - 卡朗坦（美军进攻）
23. `stalingrad_offensive_ger` - 斯大林格勒（德军进攻）
24. `stalingrad_offensive_us` - 斯大林格勒（美军进攻）

**使用示例**:
```
# 使用编号换图（推荐）
/换图 1              # 切换到卡朗坦 warfare
/换图 5 2            # 在服务器2切换到库尔斯克 warfare

# 使用完整地图名称
/换图 foy_warfare
/换图 stmereeglise_offensive_ger 2

# 使用中文名称（部分支持）
/换图 芬诺维尔
/换图 奥马哈海滩 2
```

**成功提示示例**:
```
✅ 地图切换命令已执行
🗺️ 目标地图：foy_warfare
🎮 服务器：1
⏰ 预计1分钟后生效
```

### 服务器设置

设置服务器的空闲踢出时间。

**命令格式**:
```
/设置空闲时间 <时间> [服务器编号]
/setidle <时间> [服务器编号]
```

**参数说明**:
- `时间`: 空闲时间（分钟），0 表示禁用
- `服务器编号`: 1 或 2，默认为 1

**使用示例**:
```
/设置空闲时间 10
/设置空闲时间 0 2
/setidle 15 1
```

### 管理员帮助

显示管理员命令的详细帮助信息。

**命令格式**:
```
/管理帮助
/adminhelp
```

---

## ⚙️ 系统命令

### 机器人状态

查看机器人的运行状态和统计信息。

**命令格式**:
```
/状态
/status
/机器人状态
```

**返回信息**:
- 机器人运行时间
- 内存使用情况
- 处理的消息数量
- API 连接状态

### API 测试

测试与 CRCON API 的连接状态（需要超级用户权限）。

**命令格式**:
```
/API测试 [服务器编号]
/apitest [服务器编号]
/测试连接 [服务器编号]
```

**参数说明**:
- `服务器编号`: 1 或 2，默认测试所有服务器

**使用示例**:
```
/API测试
/API测试 1
/apitest 2
```

### 机器人重启

重启机器人（需要超级用户权限）。

**命令格式**:
```
/重启机器人
/restart
```

> ⚠️ **警告**: 此命令会重启整个机器人进程，请谨慎使用。

---

## 📝 使用技巧

### 1. 玩家编号范围

在管理员命令中，您可以使用以下格式指定玩家：

- **单个玩家**: `1`
- **多个玩家**: `1,3,5`
- **连续范围**: `1-5`
- **混合格式**: `1,3-5,8`

### 2. 时间格式

在封禁命令中，支持以下时间格式：

- **分钟**: `30m`、`45min`
- **小时**: `2h`、`1hour`
- **天**: `1d`、`3day`、`1days`
- **周**: `1w`、`2week`

### 3. 地图名称

支持使用编号、中文名称或英文名称，不区分大小写：

```
/换图 1             # 使用编号（推荐）
/换图 芬诺维尔      # 中文名称
/换图 foy_warfare   # 英文名称
/换图 FOY_WARFARE   # 大写也可以
```

### 4. 引号使用

当参数包含空格时，请使用引号：

```
/踢出 1 1 "违反服务器规则"
/vip查询 "Player Name"
```

### 5. 服务器编号

- 大多数命令的服务器编号都是可选的，默认为服务器 1
- 如果只有一个服务器，可以忽略服务器编号参数

---

## ❗ 常见错误

### 1. 权限不足
```
❌ 权限不足，此命令需要超级用户权限
```
**解决方案**: 确保您的 QQ 号在配置文件的 `SUPERUSERS` 列表中。

### 2. 服务器编号无效
```
❌ 无效的服务器编号，请使用 1 或 2
```
**解决方案**: 使用正确的服务器编号（1 或 2）。

### 3. 玩家不存在
```
❌ 未找到指定编号的玩家
```
**解决方案**: 先使用 `/玩家列表` 查看当前在线玩家及其编号。

### 4. API 连接失败
```
❌ API 请求失败，请稍后重试
```
**解决方案**: 
- 检查网络连接
- 确认 CRCON 服务器是否正常运行
- 验证 API 令牌是否有效

### 5. 参数格式错误
```
❌ 参数格式错误，请查看帮助信息
```
**解决方案**: 使用 `/帮助` 或 `/管理帮助` 查看正确的命令格式。

---

## 🔧 高级用法

### 批量操作

您可以对多个玩家执行相同操作：

```
/踢出 1-5 1 批量清理
/临时封禁 1,3,5 30m 1 违规行为
/立即切换 2-4
```

### 组合命令

在管理服务器时，可以组合使用多个命令：

```
1. /玩家列表          # 查看当前玩家
2. /踢出 1-2 违规     # 踢出违规玩家
3. /换图 3            # 更换地图（使用编号）
4. /状态              # 检查机器人状态
```

### 定时任务

机器人会自动执行一些定时任务：

- **健康检查**: 每 5 分钟检查一次 API 连接状态
- **日志轮转**: 每天轮转日志文件
- **状态更新**: 定期更新机器人状态信息

---

如果您在使用过程中遇到问题，请查看日志文件或联系管理员获取帮助。